from fastapi import FastAPI,HTTPException,Response
from random import randrange
from typing import Optional
from fastapi.params import Body
from pydantic import BaseModel
from fastapi import status

app=FastAPI()

class Post(BaseModel):
    title:str
    content:str
    published: bool=True
    rating: Optional[int]=None

my_post=[{"title":"demo title","content":"demo content","id":101}]
@app.get("/")
def welcome():
    return {"message":"Welcome to FastAPI...."}
@app.get("/dummy")
def dummyData():
    return{"data":my_post}

@app.post("/create")
def postData(payload: dict= Body(...)):
    print(payload)
    return {"message": f"title {payload['title']} content: {payload['content']}"}
    #return {"message":"user added"}

@app.post("/adduser",status_code=status.HTTP_201_CREATED)
def postDataToArray(newPost:Post):
    post_dict=newPost.dict()
    post_dict['id']=randrange(0,1000000)
    my_post.append(post_dict)
    print(newPost)


   
    
    return {"message":post_dict}
